<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Generation Agent - Interactive Visualization</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-dark: #0a0a0f;
            --bg-card: #13131a;
            --bg-card-hover: #1a1a24;
            --accent-primary: #6366f1;
            --accent-secondary: #22d3ee;
            --accent-success: #10b981;
            --accent-warning: #f59e0b;
            --accent-pink: #ec4899;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border: #2a2a3c;
            --glow-primary: rgba(99, 102, 241, 0.4);
            --glow-secondary: rgba(34, 211, 238, 0.4);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Animated background */
        .bg-pattern {
            position: fixed;
            inset: 0;
            background: 
                radial-gradient(ellipse at 20% 20%, rgba(99, 102, 241, 0.08) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(34, 211, 238, 0.06) 0%, transparent 50%),
                radial-gradient(ellipse at 50% 50%, rgba(236, 72, 153, 0.04) 0%, transparent 50%);
            z-index: 0;
        }

        .grid-bg {
            position: fixed;
            inset: 0;
            background-image: 
                linear-gradient(rgba(255,255,255,0.02) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255,255,255,0.02) 1px, transparent 1px);
            background-size: 50px 50px;
            z-index: 0;
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        /* Header */
        header {
            text-align: center;
            margin-bottom: 60px;
        }

        .logo {
            display: inline-flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
        }

        .logo-icon {
            width: 56px;
            height: 56px;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            box-shadow: 0 8px 32px var(--glow-primary);
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--text-primary), var(--accent-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            font-size: 1.1rem;
            color: var(--text-secondary);
            margin-top: 12px;
            font-weight: 400;
        }

        /* Mode Selector */
        .mode-selector {
            display: flex;
            justify-content: center;
            gap: 16px;
            margin-bottom: 50px;
        }

        .mode-btn {
            padding: 14px 32px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: var(--text-secondary);
            font-size: 0.95rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .mode-btn:hover {
            background: var(--bg-card-hover);
            border-color: var(--accent-primary);
            color: var(--text-primary);
        }

        .mode-btn.active {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border-color: transparent;
            color: white;
            box-shadow: 0 8px 24px var(--glow-primary);
        }

        /* Visualization Container */
        .viz-container {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 24px;
            padding: 40px;
            margin-bottom: 40px;
            position: relative;
            overflow: hidden;
        }

        .viz-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--accent-primary), var(--accent-secondary), transparent);
        }

        .viz-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .viz-title-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        /* Agent Diagram */
        .agent-diagram {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
            min-height: 500px;
        }

        /* Single Mode Layout */
        .single-mode .agent-diagram {
            justify-content: center;
        }

        /* Agent Card */
        .agent-card {
            background: var(--bg-card-hover);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 24px;
            min-width: 280px;
            max-width: 400px;
            position: relative;
            transition: all 0.4s ease;
            cursor: pointer;
        }

        .agent-card::before {
            content: '';
            position: absolute;
            inset: -1px;
            border-radius: 16px;
            padding: 1px;
            background: linear-gradient(135deg, transparent, transparent);
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            transition: all 0.4s ease;
        }

        .agent-card:hover::before,
        .agent-card.active::before {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
        }

        .agent-card.active {
            transform: scale(1.02);
            box-shadow: 0 12px 40px var(--glow-primary);
        }

        .agent-card.orchestrator {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(34, 211, 238, 0.05));
        }

        .agent-header {
            display: flex;
            align-items: center;
            gap: 14px;
            margin-bottom: 16px;
        }

        .agent-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
        }

        .agent-icon.orchestrator {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            box-shadow: 0 4px 16px var(--glow-primary);
        }

        .agent-icon.script {
            background: linear-gradient(135deg, #f59e0b, #ef4444);
        }

        .agent-icon.media {
            background: linear-gradient(135deg, #10b981, #06b6d4);
        }

        .agent-icon.assembler {
            background: linear-gradient(135deg, #ec4899, #8b5cf6);
        }

        .agent-name {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .agent-model {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-top: 2px;
        }

        .agent-desc {
            font-size: 0.9rem;
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 16px;
        }

        .agent-tools {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .tool-tag {
            padding: 6px 12px;
            background: rgba(99, 102, 241, 0.15);
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: 6px;
            font-size: 0.75rem;
            color: var(--accent-secondary);
            font-weight: 500;
        }

        /* Sub-agents Container */
        .subagents-container {
            display: none;
            flex-direction: row;
            gap: 24px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .sequential-mode .subagents-container {
            display: flex;
        }

        /* Connection Lines */
        .connection-line {
            width: 2px;
            height: 50px;
            background: linear-gradient(180deg, var(--accent-primary), var(--accent-secondary));
            position: relative;
        }

        .connection-line::after {
            content: '';
            position: absolute;
            bottom: -6px;
            left: 50%;
            transform: translateX(-50%);
            width: 12px;
            height: 12px;
            background: var(--accent-secondary);
            border-radius: 50%;
            box-shadow: 0 0 16px var(--glow-secondary);
        }

        .horizontal-connections {
            display: none;
            align-items: center;
            gap: 20px;
            width: 100%;
            justify-content: center;
            margin: 20px 0;
        }

        .sequential-mode .horizontal-connections {
            display: flex;
        }

        .h-line {
            height: 2px;
            flex: 1;
            max-width: 120px;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
            position: relative;
        }

        .h-line::after {
            content: '‚Üí';
            position: absolute;
            right: -8px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--accent-secondary);
            font-size: 16px;
        }

        /* Data Flow Animation */
        .data-flow {
            position: absolute;
            width: 8px;
            height: 8px;
            background: var(--accent-secondary);
            border-radius: 50%;
            box-shadow: 0 0 12px var(--glow-secondary);
            animation: flowDown 2s ease-in-out infinite;
        }

        @keyframes flowDown {
            0% { top: 0; opacity: 0; }
            20% { opacity: 1; }
            80% { opacity: 1; }
            100% { top: calc(100% - 8px); opacity: 0; }
        }

        /* Workflow Steps */
        .workflow-section {
            margin-top: 50px;
        }

        .workflow-steps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 24px;
            margin-top: 24px;
        }

        .step-card {
            background: var(--bg-card-hover);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 24px;
            position: relative;
            transition: all 0.3s ease;
        }

        .step-card:hover {
            transform: translateY(-4px);
            border-color: var(--accent-primary);
            box-shadow: 0 8px 24px rgba(99, 102, 241, 0.15);
        }

        .step-number {
            position: absolute;
            top: -12px;
            left: 24px;
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.9rem;
        }

        .step-title {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 10px;
            margin-top: 10px;
            color: var(--text-primary);
        }

        .step-desc {
            font-size: 0.85rem;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        /* Interactive Demo Section */
        .demo-section {
            margin-top: 50px;
        }

        .demo-container {
            background: var(--bg-card-hover);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 32px;
        }

        .demo-controls {
            display: flex;
            gap: 16px;
            margin-bottom: 24px;
            flex-wrap: wrap;
        }

        .demo-btn {
            padding: 12px 24px;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .demo-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px var(--glow-primary);
        }

        .demo-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .demo-btn.secondary {
            background: var(--bg-card);
            border: 1px solid var(--border);
        }

        .demo-btn.secondary:hover {
            border-color: var(--accent-primary);
        }

        /* Log Output */
        .log-output {
            background: #0d0d12;
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            font-family: 'JetBrains Mono', 'Fira Code', monospace;
            font-size: 0.85rem;
            max-height: 300px;
            overflow-y: auto;
        }

        .log-line {
            padding: 6px 0;
            border-bottom: 1px solid rgba(255,255,255,0.03);
            display: flex;
            gap: 12px;
            opacity: 0;
            animation: fadeInLog 0.3s ease forwards;
        }

        @keyframes fadeInLog {
            to { opacity: 1; }
        }

        .log-time {
            color: var(--text-muted);
            min-width: 80px;
        }

        .log-agent {
            color: var(--accent-secondary);
            min-width: 120px;
            font-weight: 500;
        }

        .log-message {
            color: var(--text-secondary);
        }

        .log-message.success {
            color: var(--accent-success);
        }

        .log-message.tool {
            color: var(--accent-warning);
        }

        /* Memory/Learning Section */
        .memory-section {
            margin-top: 50px;
        }

        .memory-card {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(34, 211, 238, 0.05));
            border: 1px solid rgba(16, 185, 129, 0.3);
            border-radius: 16px;
            padding: 24px;
        }

        .memory-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }

        .memory-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--accent-success), var(--accent-secondary));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .memory-title {
            font-size: 1.1rem;
            font-weight: 600;
        }

        .memory-items {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-top: 16px;
        }

        .memory-item {
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
            padding: 16px;
        }

        .memory-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 6px;
        }

        .memory-value {
            font-size: 1rem;
            color: var(--text-primary);
            font-weight: 500;
        }

        /* Responsive */
        @media (max-width: 768px) {
            h1 {
                font-size: 1.8rem;
            }

            .mode-selector {
                flex-direction: column;
                align-items: center;
            }

            .subagents-container {
                flex-direction: column;
                align-items: center;
            }

            .horizontal-connections {
                flex-direction: column;
                height: auto;
            }

            .h-line {
                width: 2px;
                height: 30px;
                max-width: none;
            }

            .h-line::after {
                content: '‚Üì';
                right: auto;
                bottom: -8px;
                top: auto;
                left: 50%;
                transform: translateX(-50%);
            }
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-dark);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-muted);
        }

        /* Progress indicator */
        .progress-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: rgba(99, 102, 241, 0.1);
            border-radius: 20px;
            font-size: 0.85rem;
            color: var(--accent-primary);
            margin-bottom: 16px;
        }

        .progress-dot {
            width: 8px;
            height: 8px;
            background: var(--accent-primary);
            border-radius: 50%;
            animation: pulse 1.5s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(0.8); }
        }
    </style>
</head>
<body>
    <div class="bg-pattern"></div>
    <div class="grid-bg"></div>

    <div class="container">
        <header>
            <div class="logo">
                <div class="logo-icon">üé¨</div>
                <h1>Video Generation Agent</h1>
            </div>
            <p class="subtitle">Interactive visualization of agent architecture and workflow</p>
        </header>

        <!-- Mode Selector -->
        <div class="mode-selector">
            <button class="mode-btn active" data-mode="single" onclick="switchMode('single')">
                <span>üéØ</span> Single Agent Mode
            </button>
            <button class="mode-btn" data-mode="sequential" onclick="switchMode('sequential')">
                <span>üîÑ</span> Sequential Pipeline Mode
            </button>
        </div>

        <!-- Main Visualization -->
        <div class="viz-container" id="mainViz">
            <div class="viz-title">
                <div class="viz-title-icon">üèóÔ∏è</div>
                <span>Agent Architecture</span>
            </div>

            <div class="agent-diagram single-mode" id="agentDiagram">
                <!-- Main Orchestrator -->
                <div class="agent-card orchestrator" id="orchestratorCard" onclick="selectAgent('orchestrator')">
                    <div class="agent-header">
                        <div class="agent-icon orchestrator">ü§ñ</div>
                        <div>
                            <div class="agent-name">Video Orchestrator</div>
                            <div class="agent-model">gemini-2.0-flash</div>
                        </div>
                    </div>
                    <div class="agent-desc">
                        Main coordinating agent that manages the entire video generation pipeline. Uses ADK's MemoryService for cross-session learning.
                    </div>
                    <div class="agent-tools">
                        <span class="tool-tag">load_memory</span>
                        <span class="tool-tag">search_pexels</span>
                        <span class="tool-tag">generate_voiceover</span>
                        <span class="tool-tag">compose_video</span>
                        <span class="tool-tag">save_rating</span>
                    </div>
                </div>

                <!-- Connection Line -->
                <div class="connection-line" id="mainConnection">
                    <div class="data-flow"></div>
                </div>

                <!-- Sub-agents Container -->
                <div class="subagents-container" id="subagentsContainer">
                    <!-- Script Writer Agent -->
                    <div class="agent-card" id="scriptCard" onclick="selectAgent('script')">
                        <div class="agent-header">
                            <div class="agent-icon script">‚úçÔ∏è</div>
                            <div>
                                <div class="agent-name">Script Writer</div>
                                <div class="agent-model">gemini-2.0-flash</div>
                            </div>
                        </div>
                        <div class="agent-desc">
                            Creates engaging video scripts with [Visual] and [Narration] markers. Outputs to session state.
                        </div>
                        <div class="agent-tools">
                            <span class="tool-tag">output_key: generated_script</span>
                        </div>
                    </div>

                    <!-- Horizontal connection -->
                    <div class="h-line"></div>

                    <!-- Media Selector Agent -->
                    <div class="agent-card" id="mediaCard" onclick="selectAgent('media')">
                        <div class="agent-header">
                            <div class="agent-icon media">üé•</div>
                            <div>
                                <div class="agent-name">Media Selector</div>
                                <div class="agent-model">gemini-2.0-flash</div>
                            </div>
                        </div>
                        <div class="agent-desc">
                            Finds and downloads stock footage from Pexels and Pixabay for each visual segment.
                        </div>
                        <div class="agent-tools">
                            <span class="tool-tag">search_pexels</span>
                            <span class="tool-tag">download_video</span>
                            <span class="tool-tag">search_pixabay</span>
                        </div>
                    </div>

                    <!-- Horizontal connection -->
                    <div class="h-line"></div>

                    <!-- Video Assembler Agent -->
                    <div class="agent-card" id="assemblerCard" onclick="selectAgent('assembler')">
                        <div class="agent-header">
                            <div class="agent-icon assembler">üé¨</div>
                            <div>
                                <div class="agent-name">Video Assembler</div>
                                <div class="agent-model">gemini-2.0-flash</div>
                            </div>
                        </div>
                        <div class="agent-desc">
                            Generates voiceover and composes the final video from clips and audio.
                        </div>
                        <div class="agent-tools">
                            <span class="tool-tag">generate_voiceover</span>
                            <span class="tool-tag">compose_video</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Workflow Steps -->
        <div class="viz-container workflow-section">
            <div class="viz-title">
                <div class="viz-title-icon">üìã</div>
                <span>Generation Workflow</span>
            </div>

            <div class="workflow-steps">
                <div class="step-card">
                    <div class="step-number">1</div>
                    <div class="step-title">üß† Load Memory</div>
                    <div class="step-desc">Check ADK MemoryService for past user ratings and preferences. Apply learned improvements.</div>
                </div>

                <div class="step-card">
                    <div class="step-number">2</div>
                    <div class="step-title">‚úçÔ∏è Script Creation</div>
                    <div class="step-desc">Generate video script with [Visual] descriptions and [Narration] text for 30-60 seconds.</div>
                </div>

                <div class="step-card">
                    <div class="step-number">3</div>
                    <div class="step-title">üîç Media Search</div>
                    <div class="step-desc">Search Pexels/Pixabay for stock footage matching each visual segment in the script.</div>
                </div>

                <div class="step-card">
                    <div class="step-number">4</div>
                    <div class="step-title">‚¨áÔ∏è Download Assets</div>
                    <div class="step-desc">Download selected video clips and prepare them for composition.</div>
                </div>

                <div class="step-card">
                    <div class="step-number">5</div>
                    <div class="step-title">üéôÔ∏è Voiceover</div>
                    <div class="step-desc">Generate AI voiceover from combined narration text using TTS.</div>
                </div>

                <div class="step-card">
                    <div class="step-number">6</div>
                    <div class="step-title">üé¨ Compose Video</div>
                    <div class="step-desc">Assemble clips with transitions, add audio track, export final video.</div>
                </div>
            </div>
        </div>

        <!-- Interactive Demo -->
        <div class="viz-container demo-section">
            <div class="viz-title">
                <div class="viz-title-icon">‚ñ∂Ô∏è</div>
                <span>Interactive Simulation</span>
            </div>

            <div class="demo-container">
                <div class="demo-controls">
                    <button class="demo-btn" id="startBtn" onclick="startSimulation()">
                        <span>‚ñ∂Ô∏è</span> Start Simulation
                    </button>
                    <button class="demo-btn secondary" onclick="resetSimulation()">
                        <span>üîÑ</span> Reset
                    </button>
                </div>

                <div id="progressIndicator" class="progress-indicator" style="display: none;">
                    <div class="progress-dot"></div>
                    <span id="progressText">Initializing...</span>
                </div>

                <div class="log-output" id="logOutput">
                    <div class="log-line">
                        <span class="log-time">--:--:--</span>
                        <span class="log-agent">System</span>
                        <span class="log-message">Click "Start Simulation" to see the agent workflow in action</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Memory/Learning Section -->
        <div class="viz-container memory-section">
            <div class="memory-card">
                <div class="memory-header">
                    <div class="memory-icon">üß†</div>
                    <div class="memory-title">ADK Learning System</div>
                </div>
                <p style="color: var(--text-secondary); margin-bottom: 16px;">
                    The agent uses Google ADK's MemoryService to learn from user feedback across sessions.
                </p>
                <div class="memory-items">
                    <div class="memory-item">
                        <div class="memory-label">Memory Service</div>
                        <div class="memory-value">InMemoryMemoryService</div>
                    </div>
                    <div class="memory-item">
                        <div class="memory-label">Session Service</div>
                        <div class="memory-value">InMemorySessionService</div>
                    </div>
                    <div class="memory-item">
                        <div class="memory-label">Learning Tool</div>
                        <div class="memory-value">load_memory</div>
                    </div>
                    <div class="memory-item">
                        <div class="memory-label">Rating Tool</div>
                        <div class="memory-value">save_generation_rating</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Mode switching
        function switchMode(mode) {
            const diagram = document.getElementById('agentDiagram');
            const buttons = document.querySelectorAll('.mode-btn');
            
            buttons.forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.mode === mode) {
                    btn.classList.add('active');
                }
            });

            if (mode === 'sequential') {
                diagram.classList.remove('single-mode');
                diagram.classList.add('sequential-mode');
            } else {
                diagram.classList.remove('sequential-mode');
                diagram.classList.add('single-mode');
            }
        }

        // Agent selection
        function selectAgent(agent) {
            const cards = document.querySelectorAll('.agent-card');
            cards.forEach(card => card.classList.remove('active'));
            
            const targetCard = document.getElementById(agent + 'Card') || 
                               document.getElementById(agent === 'orchestrator' ? 'orchestratorCard' : agent + 'Card');
            if (targetCard) {
                targetCard.classList.add('active');
            }
        }

        // Simulation
        let simulationRunning = false;
        const simulationSteps = [
            { agent: 'Orchestrator', message: 'üöÄ Starting video generation...', type: 'normal' },
            { agent: 'Orchestrator', message: 'Calling load_memory to check past preferences...', type: 'tool' },
            { agent: 'Memory', message: 'Found 3 past sessions with ratings', type: 'success' },
            { agent: 'Orchestrator', message: 'Applying learned preferences: slower pacing preferred', type: 'normal' },
            { agent: 'Script Writer', message: 'Creating script for topic: "Coffee Brewing"', type: 'normal' },
            { agent: 'Script Writer', message: '[Visual: Steam rising from coffee cup]', type: 'normal' },
            { agent: 'Script Writer', message: '[Narration: "The perfect cup starts here..."]', type: 'normal' },
            { agent: 'Media Selector', message: 'Calling search_pexels_videos("coffee steam")...', type: 'tool' },
            { agent: 'Pexels API', message: '‚úì Found 8 matching videos', type: 'success' },
            { agent: 'Media Selector', message: 'Calling download_pexels_video(id: 2795175)...', type: 'tool' },
            { agent: 'Media Selector', message: '‚úì Downloaded: coffee_steam_2795175.mp4', type: 'success' },
            { agent: 'Assembler', message: 'Calling generate_voiceover(text, style="calm")...', type: 'tool' },
            { agent: 'TTS Engine', message: '‚úì Generated audio: voiceover_neutral.mp3 (32s)', type: 'success' },
            { agent: 'Assembler', message: 'Calling compose_video(clips, audio, format="horizontal")...', type: 'tool' },
            { agent: 'Video Editor', message: 'Applying crossfade transitions...', type: 'normal' },
            { agent: 'Video Editor', message: '‚úì Final video exported: coffee_brewing.mp4', type: 'success' },
            { agent: 'Orchestrator', message: 'üíæ Saving session to memory for future learning', type: 'normal' },
            { agent: 'System', message: 'üé¨ Video generation complete! Ready for rating.', type: 'success' },
        ];

        function startSimulation() {
            if (simulationRunning) return;
            simulationRunning = true;
            
            const logOutput = document.getElementById('logOutput');
            const startBtn = document.getElementById('startBtn');
            const progressIndicator = document.getElementById('progressIndicator');
            const progressText = document.getElementById('progressText');
            
            logOutput.innerHTML = '';
            startBtn.disabled = true;
            progressIndicator.style.display = 'flex';
            
            let stepIndex = 0;
            
            function runStep() {
                if (stepIndex >= simulationSteps.length) {
                    simulationRunning = false;
                    startBtn.disabled = false;
                    progressIndicator.style.display = 'none';
                    return;
                }
                
                const step = simulationSteps[stepIndex];
                const time = new Date().toLocaleTimeString('en-US', { hour12: false });
                
                progressText.textContent = step.message.substring(0, 50) + (step.message.length > 50 ? '...' : '');
                
                const logLine = document.createElement('div');
                logLine.className = 'log-line';
                logLine.innerHTML = `
                    <span class="log-time">${time}</span>
                    <span class="log-agent">${step.agent}</span>
                    <span class="log-message ${step.type}">${step.message}</span>
                `;
                logOutput.appendChild(logLine);
                logOutput.scrollTop = logOutput.scrollHeight;
                
                // Highlight corresponding agent card
                if (step.agent.includes('Orchestrator')) selectAgent('orchestrator');
                else if (step.agent.includes('Script')) selectAgent('script');
                else if (step.agent.includes('Media')) selectAgent('media');
                else if (step.agent.includes('Assembler') || step.agent.includes('Video')) selectAgent('assembler');
                
                stepIndex++;
                setTimeout(runStep, 800 + Math.random() * 600);
            }
            
            runStep();
        }

        function resetSimulation() {
            simulationRunning = false;
            const logOutput = document.getElementById('logOutput');
            const startBtn = document.getElementById('startBtn');
            const progressIndicator = document.getElementById('progressIndicator');
            
            logOutput.innerHTML = `
                <div class="log-line">
                    <span class="log-time">--:--:--</span>
                    <span class="log-agent">System</span>
                    <span class="log-message">Click "Start Simulation" to see the agent workflow in action</span>
                </div>
            `;
            startBtn.disabled = false;
            progressIndicator.style.display = 'none';
            
            document.querySelectorAll('.agent-card').forEach(card => card.classList.remove('active'));
        }
    </script>
</body>
</html>
